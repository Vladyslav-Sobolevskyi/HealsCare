class VisitorCard{constructor(e,t,i,s,a,n,r){this.api=e,this.form=t,this.modal=i,this.toggleStartBlock=s,this.dragCard=a,this.filter=n,this.loader=r,this.fragment=document.createDocumentFragment(),this.root=document.querySelector("#root")}setVisit(e){this.visit=e}async getAllCards(){this.root.innerHTML="",this.loader.toggle(!0);const e=await this.api.getVisits();console.log(e),this.renderCards(e),this.filter.setCards(e)}renderCards(e){e.forEach((e=>{const t=document.createElement("div");t.classList.add("visit-card",`visit-card--${e.choosingDoctor}`),t.draggable="true",t.id=e.id;const i=document.createElement("div");i.className="visit-card__header";const s=document.createElement("div");s.className="visit-card__footer";const a=document.createElement("div");a.className="visit-card__info";const n=document.createElement("h3");n.className="visit-card__name",n.innerHTML=e.nameVisitor;const r=document.createElement("p");r.className="visit-card__status",r.innerHTML=`<span class="visit-card__status--span">Visit status</span> ${e.statusVisit.charAt(0).toUpperCase()+e.statusVisit.slice(1)}`;const c=document.createElement("p");c.className="visit-card__doctor",c.innerHTML=`<span class="visit-card__doctor--span">Doctor</span> ${e.choosingDoctor.charAt(0).toUpperCase()+e.choosingDoctor.slice(1)}`,a.append(n,r,c);const o=document.createElement("div");o.className="visit-card__button--delete",o.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" width="11" height="10" viewBox="0 0 11 10">\n            <path fill-rule="evenodd" clip-rule="evenodd" d="M1.6058 0.27746C1.24717 -0.0933955 0.652323 -0.0923455 0.295014 0.279774C-0.0440406 0.632883 -0.0430555 1.19093 0.297244 1.54284L3.6251 4.98423L0.297134 8.42573C-0.0431653 8.77764 -0.0441509 9.33569 0.294904 9.68879C0.652213 10.0609 1.24706 10.062 1.60569 9.69111L4.25414 6.9523C4.69261 6.49887 5.41951 6.49887 5.85799 6.9523L8.50644 9.69111C8.86506 10.062 9.45991 10.0609 9.81722 9.6888C10.1563 9.33569 10.1553 8.77764 9.81499 8.42573L6.48714 4.98434L9.8151 1.54284C10.1554 1.19093 10.1564 0.632884 9.81733 0.279774C9.46002 -0.0923454 8.86517 -0.093395 8.50655 0.277461L5.8581 3.01627C5.41962 3.4697 4.69272 3.4697 4.25425 3.01627L1.6058 0.27746Z"/>\n            </svg>\n            ',o.addEventListener("click",(async i=>{i.preventDefault();if(await this.api.deleteVisit(t.id)){document.getElementById(t.id).remove(),this.filter.removeCard(e.id),this.toggleStartBlock()}})),i.append(a,o);const d=this.form._renderButton("button","visit-card__button visit-card__button--detailed","Detailed");d.addEventListener("click",(t=>{t.preventDefault(),this.detailedCard(e)}));const l=this.form._renderButton("button","visit-card__button visit-card__button--edit","Edit");l.addEventListener("click",(async t=>{t.preventDefault();const i=await this.api.getVisits(e.id);this.visit.visitForm(i)})),s.append(d,l),t.append(i,s),this.fragment.append(t)})),this.root.append(this.fragment),this.toggleStartBlock(),this.loader.toggle(!1),this.dragCard()}editCards(e){this.loader.toggle(!1);const t=document.getElementById(e.id);console.log(t);t.querySelector(".visit-card__name").textContent=e.nameVisitor;t.querySelector(".visit-card__status").textContent=e.statusVisit;t.querySelector(".visit-card__doctor").textContent=e.choosingDoctor}detailedCard(e){const t={age:"Age",bmi:"Body mass index",diseaseHistory:"Cardiovascular diseases",pressure:"Pressure",chronicDiseases:"Chronic diseases",currentMedications:"What medication does take",hasAllergies:"Allergy",temperature:"Temperature",hasPain:"The presence of pain",lastVisitDate:"Last visit date"},i=document.createElement("div");i.className="detailed-container";const s=document.createDocumentFragment(),a=document.createElement("h3");a.className="detailed-container__item",a.innerHTML=`<span class="detailed-container__label">Client name</span> ${e.nameVisitor}`;const n=document.createElement("p");n.className="detailed-container__item",n.innerHTML=`<span class="detailed-container__label">Visit status</span> ${e.statusVisit}`;const r=document.createElement("p");r.className="detailed-container__item",r.innerHTML=`<span class="detailed-container__label">Appointed doctor</span> ${e.choosingDoctor}`;const c=document.createElement("p");switch(c.className="detailed-container__item detailed-container__urgency",c.innerHTML=`<span class="detailed-container__label">Urgency</span> ${e.urgencyVisit}`,e.urgencyVisit){case"regular":c.classList.add("detailed-container__urgency--regular");break;case"priority":c.classList.add("detailed-container__urgency--priority");break;case"urgent":c.classList.add("detailed-container__urgency--urgent")}const o=document.createElement("p");o.className="detailed-container__item",o.innerHTML=`<span class="detailed-container__label">Description of the visit</span> ${e.descriptionVisit}`;const d=document.createElement("p");d.className="detailed-container__item",d.innerHTML=`<span class="detailed-container__label">Brief description of the visit</span> ${e.briefDescriptionVisit}`,s.append(a,n,r,c,o,d);const l=["nameVisitor","statusVisit","choosingDoctor","urgencyVisit","descriptionVisit","briefDescriptionVisit","id"];for(const i in e)if(!l.includes(i)){const a=document.createElement("p");a.className="detailed-container__item",a.innerHTML=`<span class="detailed-container__label">${t[i]}</span> ${e[i]}`,s.append(a)}i.append(s),this.modal.open(i)}}export default VisitorCard;